<% include ./partials/header.ejs %>

<div class="container pad-top">
  <div class="row">
    <div class="col-md-10 col-md-offset-1">
      <!--<h1>My Transactions</h1>
      <a class="new-post btn btn-primary" href="/new">Create New Transaction</a>
      -->
<div class="row">
<div class="column" style="overflow:auto; border-style:solid; border-color:lightGrey; border-radius:8px;">
<% transactions.forEach(function (transaction) {%>

      <div>
        <h2><a href="/<%= transaction.doc._id %>"><%= transaction.doc.title %></a></h2>
        <p><%= transaction.doc.date %></p>
        <p><%= transaction.doc.sign %>$<%= transaction.doc.amount %></p>
      </div>
<% if ( Object.is((transaction.doc.sign),'+' )) {
  sumPos = sumPos + transaction.doc.amount;
   } else {
   
   sumNeg = sumNeg + transaction.doc.amount;
   
   if (Object.is((transaction.doc.category),"groceries")) {
      sumGroceries = sumGroceries + transaction.doc.amount;
   } else if (Object.is((transaction.doc.category),"fun")) {
      sumFun = sumFun + transaction.doc.amount;
   } else if (Object.is ((transaction.doc.category),"shopping")) {
      sumShopping = sumShopping + transaction.doc.amount;
   }
   else {
      sumOther = sumOther + transaction.doc.amount;
   }

   console.log('Groceries:' + sumGroceries);
   console.log('Fun: ' + sumFun);
   console.log('Shopping: ' + sumShopping);
   console.log('Other: ' + sumOther);
   }
})
%>
</div>
<div class="column">
        <h2> You have gotten $<%= sumPos %></h2>
        <h2> You have spent $<%= sumNeg %></h2>
</div>

<!-- BEGIN WYE MUN'S EXPERIMENT -->
<div id="donut_single" class="column" style="height:720px; padding-bottom:300px"></div>

       <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
           <script>
                  google.charts.load('current', {'packages':['corechart']});
                  google.charts.setOnLoadCallback(drawChart);

                  function drawChart() {
                        var data = google.visualization.arrayToDataTable([
                                        ['Category','Amount spent'], 
                                        ['Groceries',<%= sumGroceries %>],
                                        ['Fun', <%= sumFun %>],
                                        ['Shopping',<%= sumShopping %>],
                                        ['Other',<%= sumOther %>]]);

                        console.log(data);

                        var options = {backgroundColor:'#FFFFFF', pieHole: 0.4,
                                        pieSliceTextStyle:{ color:'black',},
                                        colors:['#D2113F','#211D38','#F7FFF7',
                                                '#AFFFA4','#f6c7b6'],legend:'none',
                                        animation:{duration:1000, easing:'in',
                                                   startup:'true',},};

                        var chart = new google.visualization.PieChart(document.getElementById('donut_single'));
                        chart.draw(data,options);
                }


         </script>




    </div>
    </div>
  </div>
</div>

<% include ./partials/footer.ejs %>
